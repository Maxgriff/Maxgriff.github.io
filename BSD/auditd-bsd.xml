<decoder name="auditbsd-syscall">
  <prematch type="pcre2">^header,\d+,\d+,execve\(2\),\d+,[\w\d :]+,[ +\d\w]+,exec arg,.*?,exec env,.*?,p</prematch>
</decoder>

<decoder name="auditbsd-syscall-success">
  <parent>auditbsd-syscall</parent>
  <prematch offset="after_parent" type="pcre2">ath,.*?,attribute</prematch>
  <regex type="pcre2">^header,(\d+),\d+,(execve)\(2\),\d+,([\w\d :]+),[ +\d\w]+,exec arg,(.*?),exec env,(.*?),path,(.*?),attribute,.*?,subject,(.*?),(.*?),(.*?),(.*?),(.*?),(\d+),(\d+),(\d+),(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}),return,(.*?),\d+</regex>
  <order>audit.num,audit.type,audit.time,audit.args,audit.env,audit.binary_path,audit.user_actual,audit.user_effective,audit.group_effectve,audit.user_real,audit.group_real,audit.process_id,audit.session_id,audit.rport,audit.rhost,audit.returns</order>
</decoder>

<decoder name="auditbsd-syscall-failure">
  <parent>auditbsd-syscall</parent>
  <prematch offset="after_parent" type="pcre2">ath,.*?,subject</prematch>
  <regex type="pcre2">^header,(\d+),\d+,(execve)\(2\),\d+,([\w\d :]+),[ +\d\w]+,exec arg,(.*?),exec env,(.*?),path,(.*?),subject,(.*?),(.*?),(.*?),(.*?),(.*?),(\d+),(\d+),(\d+),(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}),return,(.*?),\d+</regex>
  <order>audit.num,audit.type,audit.time,audit.args,audit.env,audit.binary_path,audit.user_actual,audit.user_effective,audit.group_effectve,audit.user_real,audit.group_real,audit.process_id,audit.session_id,audit.rport,audit.rhost,audit.returns</order>
</decoder>

<decoder name="auditbsd-login">
  <prematch type="pcre2">^header,\d+,\d+,\S+ login</prematch>
</decoder>

<decoder name="auditbsd-ssh-login">
  <parent>auditbsd-login</parent>
  <regex type="pcre2">^header,(\d+),\d+,(\S+ login),\d+,(.*?), .*?,subject_ex,(.*?),(.*?),(.*?),(.*?),(.*?),(\d+),(\d+),(\d+),(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}),text,(.*?),return,(.*?),\d+</regex>
  <order>audit.num,audit.type,audit.time,audit.user_actual,audit.user_effective,audit.group_effectve,audit.user_real,audit.group_real,audit.process_id,audit.session_id,audit.rport,audit.rhost,audit.result,audit.returns</order>
</decoder>

<decoder name="auditbsd-open">
  <prematch type="pcre2">^header,\d+,\d+,open\S+ - (\D+)\d+,([\w\d :]*),.*?,p</prematch>
</decoder>

<decoder name="auditbsd-write-with-attributes">
  <parent>auditbsd-open</parent>
  <prematch offset="after_parent" type="pcre2">ath,.*?,attribute</prematch>
  <regex type="pcre2">^header,(\d+),\d+,(open)\S+ - (\D+)\d+,([\w\d :]*),.*?,path,(.*?),attribute,.*?,subject,(.*?),(.*?),(.*?),(.*?),(.*?),(\d+),(\d+),(\d+),(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}),return,(.*?),(\d+)</regex>
  <order>audit.num,audit.type,audit.mode,audit.time,audit.file,audit.user_actual,audit.user_effective,audit.group_effectve,audit.user_real,audit.group_real,audit.process_id,audit.session_id,audit.rport,audit.rhost,audit.result,audit.return_code</order>
</decoder>

<decoder name="auditbsd-write-without-attributes">
  <parent>auditbsd-open</parent>
  <prematch offset="after_parent" type="pcre2">ath,.*?,subject</prematch>
  <regex type="pcre2">^header,(\d+),\d+,(open)\S+ - (\D+)\d+,([\w\d :]*),.*?,path,(.*?),subject,(.*?),(.*?),(.*?),(.*?),(.*?),(\d+),(\d+),(\d+),(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}),return,(.*?),(\d+)</regex>
  <order>audit.num,audit.type,audit.mode,audit.time,audit.file,audit.user_actual,audit.user_effective,audit.group_effectve,audit.user_real,audit.group_real,audit.process_id,audit.session_id,audit.rport,audit.rhost,audit.result,audit.return_code</order>
</decoder>

<decoder name="auditbsd-audit-actions">
  <prematch>^header,\d+,\d+,audit </prematch>
  <regex offset="after_prematch" type="pcre2">(\w+),\d+,([\w\d :]*),.*?,trailer</regex>
  <order>audit.type,audit.time</order>
</decoder>
